import{j as s,u as oe,m as ie}from"./framer-motion-IGSP7b5K.js";import{a as B,I as re}from"./withContentPage-XuNeQCE0.js";import{a as u}from"./react-vendor-CRtdKe_D.js";function le({src:n,caption:e}){const a=u.useRef(null);return u.useEffect(()=>{const t=a.current;if(!t)return;t.setAttribute("playsinline","true"),t.setAttribute("muted","true"),t.muted=!0,t.autoplay=!0,t.controls=!1;const i=async()=>{try{await t.play(),t.controls=!1}catch{t.controls=!0}};if(t.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA){i();return}const m=()=>{i()};return t.addEventListener("loadeddata",m,{once:!0}),()=>{t.removeEventListener("loadeddata",m)}},[n]),s.jsx(B,{caption:e,children:s.jsx("video",{ref:a,src:n,className:"w-full h-auto object-cover",style:{objectPosition:"center"},preload:"auto",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!1,controlsList:"nodownload noremoteplayback"})})}function ce({src:n,alt:e,borderWidth:a=8}){const t=`var(--stack-border-thickness, ${a}px)`;return s.jsx("div",{className:"relative w-full h-full",style:{transformOrigin:"50% 50%"},children:s.jsxs("div",{className:"absolute inset-0 overflow-hidden bg-white transition-shadow duration-300 ease-out shadow-[0px_6px_18px_0px_rgba(0,0,0,0.22)] group-hover:shadow-[0px_3px_12px_0px_rgba(0,0,0,0.16)]",children:[s.jsx("img",{src:n,alt:e,className:"absolute inset-0 w-full h-full object-contain select-none",style:{objectPosition:"center",userSelect:"none"},draggable:!1}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-solid border-white transition-shadow duration-300 ease-out shadow-[0px_4px_12px_0px_rgba(0,0,0,0.18)] group-hover:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.12)]",style:{borderWidth:t,inset:`calc(-1 * ${t})`}})]})})}class de{cache=new Map;loadingPromises=new Map;async getDimensions(e){if(this.cache.has(e))return this.cache.get(e);if(this.loadingPromises.has(e))return this.loadingPromises.get(e);const a=this.loadImageDimensions(e);this.loadingPromises.set(e,a);const t=await a;return this.loadingPromises.delete(e),t}loadImageDimensions(e){return new Promise(a=>{const t=new Image;t.onload=()=>{const i={width:t.naturalWidth,height:t.naturalHeight,aspectRatio:t.naturalWidth/t.naturalHeight};this.cache.set(e,i),a(i)},t.onerror=()=>a(null),t.src=e})}async preloadImages(e){await Promise.all(e.map(a=>this.getDimensions(a)))}getCached(e){return this.cache.get(e)??null}clear(){this.cache.clear(),this.loadingPromises.clear()}}const O=new de;function me(n){let e=0;for(let a=0;a<n.length;a++)e=(e<<5)-e+n.charCodeAt(a);return e>>>0}function he(n){let e=n;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function pe({images:n,pageType:e="writing",height:a,mobileHeight:t,rotationMin:i=1.2,rotationMax:m=2.8,duration:w}){const[b,q]=u.useState(()=>n.map((o,r)=>r)),[C,H]=u.useState(!1),[y,T]=u.useState(!1),[v,z]=u.useState(0),[E,V]=u.useState(()=>{const o=new Map;return n.forEach((r,h)=>{const c=O.getCached(r.src);c&&o.set(h,c)}),o}),J=oe();u.useEffect(()=>{(async()=>{const r=new Map;await Promise.all(n.map(async(h,c)=>{const x=await O.getDimensions(h.src);x&&r.set(c,x)})),V(r)})()},[n]);const G=u.useMemo(()=>{const o=Math.max(i,0),r=Math.max(m-i,0),h=Math.max(n.length-1,1),c=.35,x=[];return n.map((j,l)=>{const N=he(me(`${j.src}:${l}:${v}`)),g=l%2===0?1:-1,$=(l+v)%4<2?1:-1,p=l/h,I=o+r*p,f=Math.sin((v+l)*1.13)*.2;let d=g*(I+(N()-.5)*.32+f);Math.abs(d)<o*.65&&(d=g*o*.65);let L=0;for(;x.some(P=>Math.abs(P-d)<c)&&L<6;)d+=g*(c-.05),L+=1;x.push(d);const ee=1+.25*Math.cos((v+l)*.9),W=(10+p*24)*ee,te=(N()-.5)*(3+p*3),se=Math.sin((v+l)*.7)*2;let _=g*(W+te)+se;const ae=W*.42,ne=(N()-.5)*(2.5+p*2.5);let M=$*(ae+ne);const R=12+p*8;Math.abs(_)<R&&(_=(_===0?g:Math.sign(_))*R);const F=6+p*6;return Math.abs(M)<F&&(M=(M===0?$:Math.sign(M))*F),{angle:d,tx:_,ty:M}})},[n,i,m,v]),A=b[0]??0,U=n[A]?.caption,D=E.get(A),S=a??D?.height??360,X=D?D.width:void 0,Y=t??Math.round(S*.75),k=()=>{y||b.length<2||T(!0)},K=()=>{q(([o,...r])=>[...r,o]),T(!1)},Q=w??(J?0:.4),Z=[.25,.46,.45,.94];return s.jsx(B,{pageType:e,caption:U,noBorder:!0,captionClassName:"mt-[3.25rem] md:mt-12",containerClassName:"mt-12 mb-10 md:mt-16 md:mb-18",children:s.jsx("div",{className:"relative w-full scale-[0.75] md:scale-100 [--stack-border-thickness:10.6667px] md:[--stack-border-thickness:8px]",style:{transformOrigin:"top center","--mobile-height":`${Y}px`,"--desktop-height":`${S}px`,height:"var(--mobile-height)",marginTop:"3rem",marginBottom:"2rem"},onMouseEnter:()=>H(!0),onMouseLeave:()=>{H(!1),z(o=>o+1)},children:s.jsx("div",{className:"group relative w-full mx-auto",style:{height:S,maxWidth:X},children:b.map((o,r)=>{const h=n[o],c=E.get(o),x=n.length-r,j=G[o]??{angle:0,tx:0,ty:0},l=r===0,N=r===1,g=C?0:j.angle,$=C?0:j.tx,p=C?0:j.ty,I=l&&y?0:1;let f="100%",d="100%";return c&&(a?(f=`${a*c.aspectRatio}px`,d=`${a}px`):(f=`${c.width}px`,d=`${c.height}px`)),s.jsx(ie.div,{className:"absolute left-1/2 top-1/2",style:{zIndex:x,transformOrigin:"50% 50%",width:f,height:d,marginLeft:`-${parseFloat(f)/2}${f.includes("px")?"px":"%"}`,marginTop:`-${parseFloat(d)/2}${d.includes("px")?"px":"%"}`},initial:{opacity:1,y:p,rotate:g,x:$},animate:{opacity:I,y:l&&y?-28:p,rotate:g,x:$},transition:{duration:Q,ease:Z},onAnimationComplete:()=>{l&&y&&K()},onClick:l?k:void 0,role:l?"button":void 0,"aria-label":l?"Next photo":void 0,children:s.jsx(ce,{src:h.src,alt:h.alt})},`${h.src}-${o}`)})})})})}function fe({blocks:n}){return s.jsx("div",{className:"flex flex-col gap-4 w-full overflow-visible",children:n.map((e,a)=>{if(e.type==="sectionHeader")return s.jsxs("div",{className:"flex items-center gap-3 w-full mt-8 mb-2 overflow-visible",children:[s.jsx("span",{className:"portfolio-text halbfett whitespace-nowrap",children:e.title}),s.jsx("span",{className:"flex-1 border-t",style:{borderColor:"var(--portfolio-border)"}})]},`section-${a}`);if(e.type==="text")return s.jsx("p",{className:"portfolio-text",children:e.content},`text-${a}`);if(e.type==="image"){const{image:t}=e;return s.jsx(re,{src:t.src,alt:t.alt,pageType:"writing",caption:t.caption},`image-${a}`)}if(e.type==="imageNoBorder"){const{image:t}=e;return s.jsx("div",{className:"mt-10 mb-6 w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden h-[300px] md:h-[500px]",children:[s.jsx("img",{src:t.src,alt:t.alt,className:"w-full h-full object-cover",style:{objectPosition:"center 70%"},loading:"lazy",decoding:"async"}),t.caption&&s.jsx("figcaption",{className:"absolute -bottom-3 md:bottom-1 left-1/2 -translate-x-1/2 text-sm text-[#9c9c9b] leading-relaxed text-center whitespace-nowrap",children:t.caption})]})},`image-no-border-${a}`)}if(e.type==="video"){const{video:t}=e;return s.jsx(le,{src:t.src,caption:t.caption},`video-${a}`)}if(e.type==="quote"){const{quote:t,cite:i}=e;return s.jsxs("figure",{className:"mt-6 mb-4 pl-4 border-l-2",style:{borderColor:"var(--portfolio-border)"},children:[s.jsx("blockquote",{className:"portfolio-text halbfett text-[#9c9c9b]",children:t.split(`
`).map((m,w,b)=>s.jsxs("span",{children:[m,w<b.length-1&&s.jsx("br",{})]},`${a}-line-${w}`))}),i&&s.jsxs("figcaption",{className:"mt-2 text-sm text-[#9c9c9b]",children:["â€” ",i]})]},`quote-${a}`)}if(e.type==="framedText"){const{text:t,height:i}=e,m=i??200;return s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"mt-10 mb-6 inline-image-container w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",children:[s.jsx("div",{className:"w-full flex items-center justify-center bg-white",style:{height:`${m}px`},children:s.jsx("span",{className:"portfolio-text text-[#6a6a6a]",children:t})}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-[8px] border-solid border-white inset-[-8px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]"})]})})},`framed-${a}`)}return e.type==="imageStack"?s.jsx(pe,{images:e.stack,pageType:"writing",height:e.height,mobileHeight:e.mobileHeight},`stack-${a}`):null})})}export{fe as W,O as i};
