import{j as s,u as re,m as le}from"./framer-motion-IGSP7b5K.js";import{a as k,I as ce}from"./withContentPage-XuNeQCE0.js";import{a as l}from"./react-vendor-CRtdKe_D.js";function de({src:n,alt:e,magnifierSrc:a,pageType:t="writing",caption:i,orientation:m,magnifierSize:u=180,zoomLevel:b=3.5}){const[z,p]=l.useState(!1),[N,_]=l.useState({x:0,y:0}),[C,L]=l.useState({x:0,y:0}),S=l.useRef(null),g=()=>{p(!0)},W=()=>{p(!1)},A=f=>{if(!S.current)return;const x=S.current.getBoundingClientRect(),F=f.clientX-x.left,B=f.clientY-x.top,O=f.clientX-x.left,D=f.clientY-x.top,T=F/x.width*100,X=B/x.height*100;_({x:O,y:D}),L({x:T,y:X})};return s.jsx(k,{pageType:t,orientation:m,caption:i,children:s.jsxs("div",{className:"relative w-full h-auto cursor-none",onMouseEnter:g,onMouseLeave:W,onMouseMove:A,children:[s.jsx("img",{ref:S,src:n,alt:e,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center"},loading:"lazy",decoding:"async",onError:f=>{f.currentTarget.style.visibility="hidden"}}),z&&s.jsx("div",{className:"absolute pointer-events-none rounded-full border-2 border-white shadow-[0px_4px_12px_0px_rgba(0,0,0,0.25)] overflow-hidden",style:{width:`${u}px`,height:`${u}px`,left:`${N.x}px`,top:`${N.y}px`,transform:"translate(-50%, -50%)",backgroundImage:`url('${a||n}')`,backgroundSize:`${b*100}%`,backgroundPosition:`${C.x}% ${C.y}%`,backgroundRepeat:"no-repeat",zIndex:50}})]})})}function me({src:n,caption:e}){const a=l.useRef(null);return l.useEffect(()=>{const t=a.current;if(!t)return;t.setAttribute("playsinline","true"),t.setAttribute("muted","true"),t.muted=!0,t.autoplay=!0,t.controls=!1;const i=async()=>{try{await t.play(),t.controls=!1}catch{t.controls=!0}};if(t.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA){i();return}const m=()=>{i()};return t.addEventListener("loadeddata",m,{once:!0}),()=>{t.removeEventListener("loadeddata",m)}},[n]),s.jsx(k,{caption:e,children:s.jsx("video",{ref:a,src:n,className:"w-full h-auto object-cover",style:{objectPosition:"center"},preload:"auto",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!1,controlsList:"nodownload noremoteplayback"})})}function he({src:n,alt:e,borderWidth:a=8}){const t=`var(--stack-border-thickness, ${a}px)`;return s.jsx("div",{className:"relative w-full h-full",style:{transformOrigin:"50% 50%"},children:s.jsxs("div",{className:"absolute inset-0 overflow-hidden bg-white transition-shadow duration-300 ease-out shadow-[0px_6px_18px_0px_rgba(0,0,0,0.22)] group-hover:shadow-[0px_3px_12px_0px_rgba(0,0,0,0.16)]",children:[s.jsx("img",{src:n,alt:e,className:"absolute inset-0 w-full h-full object-contain select-none",style:{objectPosition:"center",userSelect:"none"},draggable:!1}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-solid border-white transition-shadow duration-300 ease-out shadow-[0px_4px_12px_0px_rgba(0,0,0,0.18)] group-hover:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.12)]",style:{borderWidth:t,inset:`calc(-1 * ${t})`}})]})})}class ue{cache=new Map;loadingPromises=new Map;async getDimensions(e){if(this.cache.has(e))return this.cache.get(e);if(this.loadingPromises.has(e))return this.loadingPromises.get(e);const a=this.loadImageDimensions(e);this.loadingPromises.set(e,a);const t=await a;return this.loadingPromises.delete(e),t}loadImageDimensions(e){return new Promise(a=>{const t=new Image;t.onload=()=>{const i={width:t.naturalWidth,height:t.naturalHeight,aspectRatio:t.naturalWidth/t.naturalHeight};this.cache.set(e,i),a(i)},t.onerror=()=>a(null),t.src=e})}async preloadImages(e){await Promise.all(e.map(a=>this.getDimensions(a)))}getCached(e){return this.cache.get(e)??null}clear(){this.cache.clear(),this.loadingPromises.clear()}}const K=new ue;function pe(n){let e=0;for(let a=0;a<n.length;a++)e=(e<<5)-e+n.charCodeAt(a);return e>>>0}function ge(n){let e=n;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function fe({images:n,pageType:e="writing",height:a,mobileHeight:t,rotationMin:i=1.2,rotationMax:m=2.8,duration:u}){const[b,z]=l.useState(()=>n.map((o,r)=>r)),[p,N]=l.useState(!1),[_,C]=l.useState(!1),[L,S]=l.useState(!1),[g,W]=l.useState(0),[A,f]=l.useState(()=>{const o=new Map;return n.forEach((r,h)=>{const d=K.getCached(r.src);d&&o.set(h,d)}),o}),x=re();l.useEffect(()=>{if(p&&window.matchMedia("(pointer: coarse)").matches){const r=setTimeout(()=>{N(!1),W(h=>h+1)},5e3);return()=>clearTimeout(r)}},[p]),l.useEffect(()=>{(async()=>{const r=new Map;await Promise.all(n.map(async(h,d)=>{const y=await K.getDimensions(h.src);y&&r.set(d,y)})),f(r)})()},[n]);const F=l.useMemo(()=>{const o=Math.max(i,0),r=Math.max(m-i,0),h=Math.max(n.length-1,1),d=.35,y=[];return n.map((j,c)=>{const P=ge(pe(`${j.src}:${c}:${g}`)),v=c%2===0?1:-1,E=(c+g)%4<2?1:-1,w=c/h,M=o+r*w,$=Math.sin((g+c)*1.13)*.2;let I=v*(M+(P()-.5)*.32+$);Math.abs(I)<o*.65&&(I=v*o*.65);let U=0;for(;y.some(Y=>Math.abs(Y-I)<d)&&U<6;)I+=v*(d-.05),U+=1;y.push(I);const se=1+.25*Math.cos((g+c)*.9),V=(10+w*24)*se,ae=(P()-.5)*(3+w*3),ne=Math.sin((g+c)*.7)*2;let H=v*(V+ae)+ne;const oe=V*.42,ie=(P()-.5)*(2.5+w*2.5);let R=E*(oe+ie);const J=12+w*8;Math.abs(H)<J&&(H=(H===0?v:Math.sign(H))*J);const G=6+w*6;return Math.abs(R)<G&&(R=(R===0?E:Math.sign(R))*G),{angle:I,tx:H,ty:R}})},[n,i,m,g]),B=b[0]??0,O=n[B]?.caption,D=A.get(B),T=a??D?.height??360,X=D?D.width:void 0,Q=t??Math.round(T*.75),Z=()=>{_||L||b.length<2||(S(!0),setTimeout(()=>C(!0),q*400))},ee=()=>{z(([o,...r])=>[...r,o]),C(!1),S(!1)},q=u??(x?0:.28),te=[.22,1,.36,1];return s.jsx(k,{pageType:e,caption:O,noBorder:!0,captionClassName:"mt-[3.25rem] md:mt-12",containerClassName:"mt-12 mb-10 md:mt-16 md:mb-18",children:s.jsx("div",{className:"relative w-full scale-[0.75] md:scale-100 [--stack-border-thickness:10.6667px] md:[--stack-border-thickness:8px]",style:{transformOrigin:"top center","--mobile-height":`${Q}px`,"--desktop-height":`${T}px`,height:"var(--mobile-height)",marginTop:"3rem",marginBottom:"2rem"},onMouseEnter:()=>N(!0),onMouseLeave:()=>{N(!1),W(o=>o+1)},children:s.jsx("div",{className:"group relative w-full mx-auto",style:{height:T,maxWidth:X},children:b.map((o,r)=>{const h=n[o],d=A.get(o),y=n.length-r,j=F[o]??{angle:0,tx:0,ty:0},c=r===0,P=p?0:j.angle,v=p?j.tx*.2:j.tx,E=p?j.ty*.35:j.ty,w=c&&_?0:1;let M="100%",$="100%";return d&&(a?(M=`${a*d.aspectRatio}px`,$=`${a}px`):(M=`${d.width}px`,$=`${d.height}px`)),s.jsx(le.div,{className:"absolute left-1/2 top-1/2",style:{zIndex:y,transformOrigin:"50% 50%",width:M,height:$,marginLeft:`-${parseFloat(M)/2}${M.includes("px")?"px":"%"}`,marginTop:`-${parseFloat($)/2}${$.includes("px")?"px":"%"}`},initial:{opacity:1,y:E,rotate:P,x:v},animate:{opacity:w,y:c&&(L||_)?-28:E,rotate:P,x:v},transition:{duration:q,ease:te},onAnimationComplete:()=>{c&&_&&ee()},onClick:c?Z:void 0,role:c?"button":void 0,"aria-label":c?"Next photo":void 0,children:s.jsx(he,{src:h.src,alt:h.alt})},`${h.src}-${o}`)})})})})}function be({blocks:n}){return s.jsx("div",{className:"flex flex-col gap-4 w-full overflow-visible",children:n.map((e,a)=>{if(e.type==="sectionHeader")return s.jsxs("div",{className:"flex items-center gap-3 w-full mt-8 mb-2 overflow-visible",children:[s.jsx("span",{className:"portfolio-text halbfett whitespace-nowrap",children:e.title}),s.jsx("span",{className:"flex-1 border-t",style:{borderColor:"var(--portfolio-border)"}})]},`section-${a}`);if(e.type==="text")return s.jsx("p",{className:"portfolio-text",children:e.content},`text-${a}`);if(e.type==="image"){const{image:t}=e;return s.jsx(ce,{src:t.src,alt:t.alt,pageType:"writing",caption:t.caption},`image-${a}`)}if(e.type==="imageWithMagnifier"){const{image:t}=e;return s.jsx(de,{src:t.src,alt:t.alt,magnifierSrc:t.magnifierSrc,pageType:"writing",caption:t.caption},`image-magnifier-${a}`)}if(e.type==="imageNoBorder"){const{image:t}=e;return s.jsx("div",{className:"mt-10 mb-6 w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden h-[300px] md:h-[500px]",children:[s.jsx("img",{src:t.src,alt:t.alt,className:"w-full h-full object-cover",style:{objectPosition:"center 70%"},loading:"lazy",decoding:"async"}),t.caption&&s.jsx("figcaption",{className:"absolute -bottom-3 md:bottom-1 left-1/2 -translate-x-1/2 text-sm text-[#9c9c9b] leading-relaxed text-center whitespace-nowrap",children:t.caption})]})},`image-no-border-${a}`)}if(e.type==="video"){const{video:t}=e;return s.jsx(me,{src:t.src,caption:t.caption},`video-${a}`)}if(e.type==="quote"){const{quote:t,cite:i}=e;return s.jsxs("figure",{className:"mt-6 mb-4 pl-4 border-l-2",style:{borderColor:"var(--portfolio-border)"},children:[s.jsx("blockquote",{className:"portfolio-text halbfett text-[#9c9c9b]",children:t.split(`
`).map((m,u,b)=>s.jsxs("span",{children:[m,u<b.length-1&&s.jsx("br",{})]},`${a}-line-${u}`))}),i&&s.jsxs("figcaption",{className:"mt-2 text-sm text-[#9c9c9b]",children:["â€” ",i]})]},`quote-${a}`)}if(e.type==="framedText"){const{text:t,height:i}=e,m=i??200;return s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"mt-10 mb-6 inline-image-container w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",children:[s.jsx("div",{className:"w-full flex items-center justify-center bg-white",style:{height:`${m}px`},children:s.jsx("span",{className:"portfolio-text text-[#6a6a6a]",children:t})}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-[8px] border-solid border-white inset-[-8px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]"})]})})},`framed-${a}`)}return e.type==="imageStack"?s.jsx(fe,{images:e.stack,pageType:"writing",height:e.height,mobileHeight:e.mobileHeight},`stack-${a}`):null})})}export{be as W,K as i};
