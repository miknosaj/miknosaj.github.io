import{j as s,u as de,m as me}from"./framer-motion-C9WkCroo.js";import{a as F,I as ue}from"./withContentPage-Ce-yEio6.js";import{a as r}from"./react-vendor-Ble0ZDyz.js";function pe({src:a,alt:t,magnifierSrc:n,pageType:e="writing",caption:i,orientation:m,magnifierSize:u=180,zoomLevel:l=2.5}){const[D,x]=r.useState(!1),[v,_]=r.useState({x:0,y:0}),[E,W]=r.useState({x:0,y:0}),f=r.useRef(null),S=()=>{x(!0)},A=()=>{x(!1)},w=j=>{if(!f.current)return;const H=f.current.getBoundingClientRect(),L=j.clientX-H.left,k=j.clientY-H.top;_({x:L,y:k}),W({x:L,y:k})};return s.jsx(F,{pageType:e,orientation:m,caption:i,children:s.jsxs("div",{className:"relative w-full h-auto cursor-none",onMouseEnter:S,onMouseLeave:A,onMouseMove:w,children:[s.jsx("img",{ref:f,src:a,alt:t,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center"},loading:"lazy",decoding:"async",onError:j=>{j.currentTarget.style.visibility="hidden"}}),D&&f.current&&s.jsx("div",{className:"absolute pointer-events-none rounded-full border-2 border-white shadow-[0px_4px_12px_0px_rgba(0,0,0,0.25)] overflow-hidden",style:{width:`${u}px`,height:`${u}px`,left:`${v.x}px`,top:`${v.y}px`,transform:"translate(-50%, -50%)",backgroundImage:`url('${n||a}')`,backgroundSize:`${f.current.width*l}px ${f.current.height*l}px`,backgroundPosition:`${-(E.x*l-u/2)}px ${-(E.y*l-u/2)}px`,backgroundRepeat:"no-repeat",zIndex:50}})]})})}function he({src:a,caption:t}){const n=r.useRef(null);return r.useEffect(()=>{const e=n.current;if(!e)return;e.setAttribute("playsinline","true"),e.setAttribute("muted","true"),e.muted=!0,e.autoplay=!0,e.controls=!1;const i=async()=>{try{await e.play(),e.controls=!1}catch{e.controls=!0}};if(e.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA){i();return}const m=()=>{i()};return e.addEventListener("loadeddata",m,{once:!0}),()=>{e.removeEventListener("loadeddata",m)}},[a]),s.jsx(F,{caption:t,children:s.jsx("video",{ref:n,src:a,className:"w-full h-auto object-cover",style:{objectPosition:"center"},preload:"auto",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!1,controlsList:"nodownload noremoteplayback"})})}function ge({src:a,alt:t,borderWidth:n=8}){const e=`var(--stack-border-thickness, ${n}px)`;return s.jsx("div",{className:"relative w-full h-full",style:{transformOrigin:"50% 50%"},children:s.jsxs("div",{className:"absolute inset-0 overflow-hidden bg-white transition-shadow duration-300 ease-out shadow-[0px_6px_18px_0px_rgba(0,0,0,0.22)] group-hover:shadow-[0px_3px_12px_0px_rgba(0,0,0,0.16)]",children:[s.jsx("img",{src:a,alt:t,className:"absolute inset-0 w-full h-full object-contain select-none",style:{objectPosition:"center",userSelect:"none"},draggable:!1}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-solid border-white transition-shadow duration-300 ease-out shadow-[0px_4px_12px_0px_rgba(0,0,0,0.18)] group-hover:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.12)]",style:{borderWidth:e,inset:`calc(-1 * ${e})`}})]})})}class fe{cache=new Map;loadingPromises=new Map;async getDimensions(t){if(this.cache.has(t))return this.cache.get(t);if(this.loadingPromises.has(t))return this.loadingPromises.get(t);const n=this.loadImageDimensions(t);this.loadingPromises.set(t,n);const e=await n;return this.loadingPromises.delete(t),e}loadImageDimensions(t){return new Promise(n=>{const e=new Image;e.onload=()=>{const i={width:e.naturalWidth,height:e.naturalHeight,aspectRatio:e.naturalWidth/e.naturalHeight};this.cache.set(t,i),n(i)},e.onerror=()=>n(null),e.src=t})}async preloadImages(t){await Promise.all(t.map(n=>this.getDimensions(n)))}getCached(t){return this.cache.get(t)??null}clear(){this.cache.clear(),this.loadingPromises.clear()}}const Y=new fe;function xe(a){let t=0;for(let n=0;n<a.length;n++)t=(t<<5)-t+a.charCodeAt(n);return t>>>0}function ve(a){let t=a;return()=>(t=(1664525*t+1013904223)%4294967296)/4294967296}function we({images:a,pageType:t="writing",height:n,mobileHeight:e,rotationMin:i=1.2,rotationMax:m=2.8,duration:u}){const[l,D]=r.useState(()=>a.map((o,c)=>c)),[x,v]=r.useState(!1),[_,E]=r.useState(!1),[W,f]=r.useState(!1),[S,A]=r.useState(!1),[w,j]=r.useState(0),[H,L]=r.useState(()=>{const o=new Map;return a.forEach((c,h)=>{const p=Y.getCached(c.src);p&&o.set(h,p)}),o}),k=de();r.useEffect(()=>{if(x&&window.matchMedia("(pointer: coarse)").matches){const c=setTimeout(()=>{v(!1),j(h=>h+1)},5e3);return()=>clearTimeout(c)}},[x]),r.useEffect(()=>{(async()=>{const c=new Map;await Promise.all(a.map(async(h,p)=>{const M=await Y.getDimensions(h.src);M&&c.set(p,M)})),L(c)})()},[a]);const G=r.useMemo(()=>{const o=Math.max(i,0),c=Math.max(m-i,0),h=Math.max(a.length-1,1),p=.35,M=[];return a.map(($,d)=>{const I=ve(xe(`${$.src}:${d}:${w}`)),b=d%2===0?1:-1,C=(d+w)%4<2?1:-1,y=d/h,N=o+c*y,T=Math.sin((w+d)*1.13)*.2;let g=b*(N+(I()-.5)*.32+T);Math.abs(g)<o*.65&&(g=b*o*.65);let P=0;for(;M.some(z=>Math.abs(z-g)<p)&&P<6;)g+=b*(p-.05),P+=1;M.push(g);const ie=1+.25*Math.cos((w+d)*.9),V=(10+y*24)*ie,oe=(I()-.5)*(3+y*3),re=Math.sin((w+d)*.7)*2;let R=b*(V+oe)+re;const ce=V*.42,le=(I()-.5)*(2.5+y*2.5);let B=C*(ce+le);const J=12+y*8;Math.abs(R)<J&&(R=(R===0?b:Math.sign(R))*J);const X=6+y*6;return Math.abs(B)<X&&(B=(B===0?C:Math.sign(B))*X),{angle:g,tx:R,ty:B}})},[a,i,m,w]),U=l[0]??0,K=a[U]?.caption,O=H.get(U),q=n??O?.height??360,Q=O?O.width:void 0,Z=e??Math.round(q*.75),ee=()=>{if(_||W||l.length<2)return;f(!0),setTimeout(()=>E(!0),50),window.matchMedia("(pointer: coarse)").matches&&(v(!1),setTimeout(()=>v(!0),0))},te=()=>{D(([o,...c])=>[...c,o]),E(!1),f(!1),setTimeout(()=>{A(!0),setTimeout(()=>A(!1),400)},10)},se=u!==void 0?{duration:u,ease:[.22,1,.36,1]}:{type:"spring",stiffness:400,damping:30},ne={type:"spring",stiffness:500,damping:35},ae={type:"spring",stiffness:300,damping:28};return s.jsx(F,{pageType:t,caption:K,noBorder:!0,captionClassName:"mt-[3.25rem] md:mt-12",containerClassName:"mt-12 mb-10 md:mt-16 md:mb-18",children:s.jsx("div",{className:"relative w-full scale-[0.75] md:scale-100 [--stack-border-thickness:10.6667px] md:[--stack-border-thickness:8px]",style:{transformOrigin:"top center","--mobile-height":`${Z}px`,"--desktop-height":`${q}px`,height:"var(--mobile-height)",marginTop:"3rem",marginBottom:"2rem"},onMouseEnter:()=>v(!0),onMouseLeave:()=>{v(!1),j(o=>o+1)},children:s.jsx("div",{className:"group relative w-full mx-auto",style:{height:q,maxWidth:Q},children:l.map((o,c)=>{const h=a[o],p=H.get(o),M=a.length-c,$=G[o]??{angle:0,tx:0,ty:0},d=c===0,I=x?0:$.angle,b=x?$.tx*.2:$.tx,C=x?$.ty*.35:$.ty,y=d&&_?0:1;let N="100%",T="100%";p&&(n?(N=`${n*p.aspectRatio}px`,T=`${n}px`):(N=`${p.width}px`,T=`${p.height}px`));const g=c===l.length-1,P=d&&(W||_);return s.jsx(me.div,{className:"absolute left-1/2 top-1/2",style:{zIndex:M,transformOrigin:"50% 50%",width:N,height:T,marginLeft:`-${parseFloat(N)/2}${N.includes("px")?"px":"%"}`,marginTop:`-${parseFloat(T)/2}${T.includes("px")?"px":"%"}`},initial:g&&S?{opacity:0,y:C-25,rotate:I,x:b}:!1,animate:{opacity:P?0:g&&S?1:y,y:P?-40:C,rotate:I,x:b},transition:P?ne:g&&S?ae:k?{duration:0}:se,onAnimationComplete:()=>{d&&_&&te()},onClick:d?ee:void 0,role:d?"button":void 0,"aria-label":d?"Next photo":void 0,children:s.jsx(ge,{src:h.src,alt:h.alt})},`${h.src}-${o}`)})})})})}function be({src:a,alt:t,pageType:n="writing",caption:e,orientation:i,onToggle:m}){const[u,l]=r.useState(!1);return s.jsx(F,{pageType:n,orientation:i,caption:e,children:s.jsx("div",{className:"relative w-full h-auto cursor-pointer transition-opacity duration-200",onClick:m,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:s.jsx("img",{src:a,alt:t,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center",opacity:u?.9:1},loading:"lazy",decoding:"async",onError:D=>{D.currentTarget.style.visibility="hidden"}})})})}function Ne({blocks:a}){return s.jsx("div",{className:"flex flex-col gap-4 w-full overflow-visible",children:a.map((t,n)=>{if(t.type==="sectionHeader")return s.jsxs("div",{className:"flex items-center gap-3 w-full mt-8 mb-2 overflow-visible",children:[s.jsx("span",{className:"portfolio-text halbfett whitespace-nowrap",children:t.title}),s.jsx("span",{className:"flex-1 border-t",style:{borderColor:"var(--portfolio-border)",transition:"border-color 900ms cubic-bezier(0.4, 0, 0.2, 1)"}})]},`section-${n}`);if(t.type==="text")return s.jsx("p",{className:"portfolio-text",children:t.content},`text-${n}`);if(t.type==="image"){const{image:e}=t;return s.jsx(ue,{src:e.src,alt:e.alt,pageType:"writing",caption:e.caption},`image-${n}`)}if(t.type==="imageWithMagnifier"){const{image:e}=t;return s.jsx(pe,{src:e.src,alt:e.alt,magnifierSrc:e.magnifierSrc,pageType:"writing",caption:e.caption},`image-magnifier-${n}`)}if(t.type==="imageNoBorder"){const{image:e}=t;return s.jsx("div",{className:"mt-10 mb-6 w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden h-[300px] md:h-[500px]",children:[s.jsx("img",{src:e.src,alt:e.alt,className:"w-full h-full object-cover",style:{objectPosition:"center 70%"},loading:"lazy",decoding:"async"}),e.caption&&s.jsx("figcaption",{className:"absolute -bottom-3 md:bottom-1 left-1/2 -translate-x-1/2 text-sm text-[#9c9c9b] leading-relaxed text-center whitespace-nowrap",children:e.caption})]})},`image-no-border-${n}`)}if(t.type==="imageThemeToggle"){const{image:e,onToggle:i}=t;return s.jsx(be,{src:e.src,alt:e.alt,pageType:"writing",caption:e.caption,onToggle:i},`image-theme-toggle-${n}`)}if(t.type==="video"){const{video:e}=t;return s.jsx(he,{src:e.src,caption:e.caption},`video-${n}`)}if(t.type==="quote"){const{quote:e,cite:i}=t;return s.jsxs("figure",{className:"mt-6 mb-4 pl-4 border-l-2",style:{borderColor:"var(--portfolio-border)",transition:"border-color 900ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[s.jsx("blockquote",{className:"portfolio-text halbfett text-[#9c9c9b]",children:e.split(`
`).map((m,u,l)=>s.jsxs("span",{children:[m,u<l.length-1&&s.jsx("br",{})]},`${n}-line-${u}`))}),i&&s.jsxs("figcaption",{className:"mt-2 text-sm text-[#9c9c9b]",children:["— ",i]})]},`quote-${n}`)}if(t.type==="framedText"){const{text:e,height:i}=t,m=i??200;return s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"mt-10 mb-6 inline-image-container w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",children:[s.jsx("div",{className:"w-full flex items-center justify-center bg-white",style:{height:`${m}px`},children:s.jsx("span",{className:"portfolio-text text-[#6a6a6a]",children:e})}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-[8px] border-solid border-white inset-[-8px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]"})]})})},`framed-${n}`)}return t.type==="imageStack"?s.jsx(we,{images:t.stack,pageType:"writing",height:t.height,mobileHeight:t.mobileHeight},`stack-${n}`):null})})}export{Ne as W,Y as i};
