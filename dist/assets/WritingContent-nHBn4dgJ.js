import{j as s,u as re,m as ce}from"./framer-motion-IGSP7b5K.js";import{a as F,I as le}from"./withContentPage-XuNeQCE0.js";import{a as r}from"./react-vendor-CRtdKe_D.js";function de({src:n,alt:t,magnifierSrc:a,pageType:e="writing",caption:o,orientation:d,magnifierSize:u=180,zoomLevel:m=2.5}){const[P,f]=r.useState(!1),[$,N]=r.useState({x:0,y:0}),[S,R]=r.useState({x:0,y:0}),g=r.useRef(null),x=()=>{f(!0)},W=()=>{f(!1)},A=_=>{if(!g.current)return;const L=g.current.getBoundingClientRect(),B=_.clientX-L.left,C=_.clientY-L.top;N({x:B,y:C}),R({x:B,y:C})};return s.jsx(F,{pageType:e,orientation:d,caption:o,children:s.jsxs("div",{className:"relative w-full h-auto cursor-none",onMouseEnter:x,onMouseLeave:W,onMouseMove:A,children:[s.jsx("img",{ref:g,src:n,alt:t,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center"},loading:"lazy",decoding:"async",onError:_=>{_.currentTarget.style.visibility="hidden"}}),P&&g.current&&s.jsx("div",{className:"absolute pointer-events-none rounded-full border-2 border-white shadow-[0px_4px_12px_0px_rgba(0,0,0,0.25)] overflow-hidden",style:{width:`${u}px`,height:`${u}px`,left:`${$.x}px`,top:`${$.y}px`,transform:"translate(-50%, -50%)",backgroundImage:`url('${a||n}')`,backgroundSize:`${g.current.width*m}px ${g.current.height*m}px`,backgroundPosition:`${-(S.x*m-u/2)}px ${-(S.y*m-u/2)}px`,backgroundRepeat:"no-repeat",zIndex:50}})]})})}function me({src:n,caption:t}){const a=r.useRef(null);return r.useEffect(()=>{const e=a.current;if(!e)return;e.setAttribute("playsinline","true"),e.setAttribute("muted","true"),e.muted=!0,e.autoplay=!0,e.controls=!1;const o=async()=>{try{await e.play(),e.controls=!1}catch{e.controls=!0}};if(e.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA){o();return}const d=()=>{o()};return e.addEventListener("loadeddata",d,{once:!0}),()=>{e.removeEventListener("loadeddata",d)}},[n]),s.jsx(F,{caption:t,children:s.jsx("video",{ref:a,src:n,className:"w-full h-auto object-cover",style:{objectPosition:"center"},preload:"auto",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!1,controlsList:"nodownload noremoteplayback"})})}function ue({src:n,alt:t,borderWidth:a=8}){const e=`var(--stack-border-thickness, ${a}px)`;return s.jsx("div",{className:"relative w-full h-full",style:{transformOrigin:"50% 50%"},children:s.jsxs("div",{className:"absolute inset-0 overflow-hidden bg-white transition-shadow duration-300 ease-out shadow-[0px_6px_18px_0px_rgba(0,0,0,0.22)] group-hover:shadow-[0px_3px_12px_0px_rgba(0,0,0,0.16)]",children:[s.jsx("img",{src:n,alt:t,className:"absolute inset-0 w-full h-full object-contain select-none",style:{objectPosition:"center",userSelect:"none"},draggable:!1}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-solid border-white transition-shadow duration-300 ease-out shadow-[0px_4px_12px_0px_rgba(0,0,0,0.18)] group-hover:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.12)]",style:{borderWidth:e,inset:`calc(-1 * ${e})`}})]})})}class he{cache=new Map;loadingPromises=new Map;async getDimensions(t){if(this.cache.has(t))return this.cache.get(t);if(this.loadingPromises.has(t))return this.loadingPromises.get(t);const a=this.loadImageDimensions(t);this.loadingPromises.set(t,a);const e=await a;return this.loadingPromises.delete(t),e}loadImageDimensions(t){return new Promise(a=>{const e=new Image;e.onload=()=>{const o={width:e.naturalWidth,height:e.naturalHeight,aspectRatio:e.naturalWidth/e.naturalHeight};this.cache.set(t,o),a(o)},e.onerror=()=>a(null),e.src=t})}async preloadImages(t){await Promise.all(t.map(a=>this.getDimensions(a)))}getCached(t){return this.cache.get(t)??null}clear(){this.cache.clear(),this.loadingPromises.clear()}}const Y=new he;function pe(n){let t=0;for(let a=0;a<n.length;a++)t=(t<<5)-t+n.charCodeAt(a);return t>>>0}function ge(n){let t=n;return()=>(t=(1664525*t+1013904223)%4294967296)/4294967296}function fe({images:n,pageType:t="writing",height:a,mobileHeight:e,rotationMin:o=1.2,rotationMax:d=2.8,duration:u}){const[m,P]=r.useState(()=>n.map((i,c)=>c)),[f,$]=r.useState(!1),[N,S]=r.useState(!1),[R,g]=r.useState(!1),[x,W]=r.useState(0),[A,_]=r.useState(()=>{const i=new Map;return n.forEach((c,p)=>{const h=Y.getCached(c.src);h&&i.set(p,h)}),i}),L=re();r.useEffect(()=>{if(f&&window.matchMedia("(pointer: coarse)").matches){const c=setTimeout(()=>{$(!1),W(p=>p+1)},5e3);return()=>clearTimeout(c)}},[f]),r.useEffect(()=>{(async()=>{const c=new Map;await Promise.all(n.map(async(p,h)=>{const b=await Y.getDimensions(p.src);b&&c.set(h,b)})),_(c)})()},[n]);const B=r.useMemo(()=>{const i=Math.max(o,0),c=Math.max(d-o,0),p=Math.max(n.length-1,1),h=.35,b=[];return n.map((y,l)=>{const T=ge(pe(`${y.src}:${l}:${x}`)),v=l%2===0?1:-1,D=(l+x)%4<2?1:-1,w=l/p,j=i+c*w,M=Math.sin((x+l)*1.13)*.2;let I=v*(j+(T()-.5)*.32+M);Math.abs(I)<i*.65&&(I=v*i*.65);let U=0;for(;b.some(k=>Math.abs(k-I)<h)&&U<6;)I+=v*(h-.05),U+=1;b.push(I);const se=1+.25*Math.cos((x+l)*.9),V=(10+w*24)*se,ae=(T()-.5)*(3+w*3),ne=Math.sin((x+l)*.7)*2;let E=v*(V+ae)+ne;const oe=V*.42,ie=(T()-.5)*(2.5+w*2.5);let H=D*(oe+ie);const J=12+w*8;Math.abs(E)<J&&(E=(E===0?v:Math.sign(E))*J);const X=6+w*6;return Math.abs(H)<X&&(H=(H===0?D:Math.sign(H))*X),{angle:I,tx:E,ty:H}})},[n,o,d,x]),C=m[0]??0,G=n[C]?.caption,O=A.get(C),q=a??O?.height??360,K=O?O.width:void 0,Q=e??Math.round(q*.75),Z=()=>{N||R||m.length<2||(g(!0),setTimeout(()=>S(!0),z*400))},ee=()=>{P(([i,...c])=>[...c,i]),S(!1),g(!1)},z=u??(L?0:.28),te=[.22,1,.36,1];return s.jsx(F,{pageType:t,caption:G,noBorder:!0,captionClassName:"mt-[3.25rem] md:mt-12",containerClassName:"mt-12 mb-10 md:mt-16 md:mb-18",children:s.jsx("div",{className:"relative w-full scale-[0.75] md:scale-100 [--stack-border-thickness:10.6667px] md:[--stack-border-thickness:8px]",style:{transformOrigin:"top center","--mobile-height":`${Q}px`,"--desktop-height":`${q}px`,height:"var(--mobile-height)",marginTop:"3rem",marginBottom:"2rem"},onMouseEnter:()=>$(!0),onMouseLeave:()=>{$(!1),W(i=>i+1)},children:s.jsx("div",{className:"group relative w-full mx-auto",style:{height:q,maxWidth:K},children:m.map((i,c)=>{const p=n[i],h=A.get(i),b=n.length-c,y=B[i]??{angle:0,tx:0,ty:0},l=c===0,T=f?0:y.angle,v=f?y.tx*.2:y.tx,D=f?y.ty*.35:y.ty,w=l&&N?0:1;let j="100%",M="100%";return h&&(a?(j=`${a*h.aspectRatio}px`,M=`${a}px`):(j=`${h.width}px`,M=`${h.height}px`)),s.jsx(ce.div,{className:"absolute left-1/2 top-1/2",style:{zIndex:b,transformOrigin:"50% 50%",width:j,height:M,marginLeft:`-${parseFloat(j)/2}${j.includes("px")?"px":"%"}`,marginTop:`-${parseFloat(M)/2}${M.includes("px")?"px":"%"}`},initial:{opacity:1,y:D,rotate:T,x:v},animate:{opacity:w,y:l&&(R||N)?-28:D,rotate:T,x:v},transition:{duration:z,ease:te},onAnimationComplete:()=>{l&&N&&ee()},onClick:l?Z:void 0,role:l?"button":void 0,"aria-label":l?"Next photo":void 0,children:s.jsx(ue,{src:p.src,alt:p.alt})},`${p.src}-${i}`)})})})})}function xe({src:n,alt:t,pageType:a="writing",caption:e,orientation:o,onToggle:d}){const[u,m]=r.useState(!1);return s.jsx(F,{pageType:a,orientation:o,caption:e,children:s.jsx("div",{className:"relative w-full h-auto cursor-pointer transition-opacity duration-200",onClick:d,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:s.jsx("img",{src:n,alt:t,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center",opacity:u?.9:1},loading:"lazy",decoding:"async",onError:P=>{P.currentTarget.style.visibility="hidden"}})})})}function ye({blocks:n}){return s.jsx("div",{className:"flex flex-col gap-4 w-full overflow-visible",children:n.map((t,a)=>{if(t.type==="sectionHeader")return s.jsxs("div",{className:"flex items-center gap-3 w-full mt-8 mb-2 overflow-visible",children:[s.jsx("span",{className:"portfolio-text halbfett whitespace-nowrap",children:t.title}),s.jsx("span",{className:"flex-1 border-t",style:{borderColor:"var(--portfolio-border)",transition:"border-color 900ms cubic-bezier(0.4, 0, 0.2, 1)"}})]},`section-${a}`);if(t.type==="text")return s.jsx("p",{className:"portfolio-text",children:t.content},`text-${a}`);if(t.type==="image"){const{image:e}=t;return s.jsx(le,{src:e.src,alt:e.alt,pageType:"writing",caption:e.caption},`image-${a}`)}if(t.type==="imageWithMagnifier"){const{image:e}=t;return s.jsx(de,{src:e.src,alt:e.alt,magnifierSrc:e.magnifierSrc,pageType:"writing",caption:e.caption},`image-magnifier-${a}`)}if(t.type==="imageNoBorder"){const{image:e}=t;return s.jsx("div",{className:"mt-10 mb-6 w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden h-[300px] md:h-[500px]",children:[s.jsx("img",{src:e.src,alt:e.alt,className:"w-full h-full object-cover",style:{objectPosition:"center 70%"},loading:"lazy",decoding:"async"}),e.caption&&s.jsx("figcaption",{className:"absolute -bottom-3 md:bottom-1 left-1/2 -translate-x-1/2 text-sm text-[#9c9c9b] leading-relaxed text-center whitespace-nowrap",children:e.caption})]})},`image-no-border-${a}`)}if(t.type==="imageThemeToggle"){const{image:e,onToggle:o}=t;return s.jsx(xe,{src:e.src,alt:e.alt,pageType:"writing",caption:e.caption,onToggle:o},`image-theme-toggle-${a}`)}if(t.type==="video"){const{video:e}=t;return s.jsx(me,{src:e.src,caption:e.caption},`video-${a}`)}if(t.type==="quote"){const{quote:e,cite:o}=t;return s.jsxs("figure",{className:"mt-6 mb-4 pl-4 border-l-2",style:{borderColor:"var(--portfolio-border)"},children:[s.jsx("blockquote",{className:"portfolio-text halbfett text-[#9c9c9b]",children:e.split(`
`).map((d,u,m)=>s.jsxs("span",{children:[d,u<m.length-1&&s.jsx("br",{})]},`${a}-line-${u}`))}),o&&s.jsxs("figcaption",{className:"mt-2 text-sm text-[#9c9c9b]",children:["â€” ",o]})]},`quote-${a}`)}if(t.type==="framedText"){const{text:e,height:o}=t,d=o??200;return s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"mt-10 mb-6 inline-image-container w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",children:[s.jsx("div",{className:"w-full flex items-center justify-center bg-white",style:{height:`${d}px`},children:s.jsx("span",{className:"portfolio-text text-[#6a6a6a]",children:e})}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-[8px] border-solid border-white inset-[-8px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]"})]})})},`framed-${a}`)}return t.type==="imageStack"?s.jsx(fe,{images:t.stack,pageType:"writing",height:t.height,mobileHeight:t.mobileHeight},`stack-${a}`):null})})}export{ye as W,Y as i};
