import{j as s,u as re,m as ce}from"./framer-motion-IGSP7b5K.js";import{a as F,I as le}from"./withContentPage-XuNeQCE0.js";import{a as r}from"./react-vendor-CRtdKe_D.js";function de({src:n,alt:t,magnifierSrc:a,pageType:e="writing",caption:i,orientation:d,magnifierSize:m=180,zoomLevel:u=2.5}){const[P,f]=r.useState(!1),[x,N]=r.useState({x:0,y:0}),[S,R]=r.useState({x:0,y:0}),g=r.useRef(null),v=()=>{f(!0)},W=()=>{f(!1)},A=_=>{if(!g.current)return;const L=g.current.getBoundingClientRect(),B=_.clientX-L.left,D=_.clientY-L.top;N({x:B,y:D}),R({x:B,y:D})};return s.jsx(F,{pageType:e,orientation:d,caption:i,children:s.jsxs("div",{className:"relative w-full h-auto cursor-none",onMouseEnter:v,onMouseLeave:W,onMouseMove:A,children:[s.jsx("img",{ref:g,src:n,alt:t,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center"},loading:"lazy",decoding:"async",onError:_=>{_.currentTarget.style.visibility="hidden"}}),P&&g.current&&s.jsx("div",{className:"absolute pointer-events-none rounded-full border-2 border-white shadow-[0px_4px_12px_0px_rgba(0,0,0,0.25)] overflow-hidden",style:{width:`${m}px`,height:`${m}px`,left:`${x.x}px`,top:`${x.y}px`,transform:"translate(-50%, -50%)",backgroundImage:`url('${a||n}')`,backgroundSize:`${g.current.width*u}px ${g.current.height*u}px`,backgroundPosition:`${-(S.x*u-m/2)}px ${-(S.y*u-m/2)}px`,backgroundRepeat:"no-repeat",zIndex:50}})]})})}function ue({src:n,caption:t}){const a=r.useRef(null);return r.useEffect(()=>{const e=a.current;if(!e)return;e.setAttribute("playsinline","true"),e.setAttribute("muted","true"),e.muted=!0,e.autoplay=!0,e.controls=!1;const i=async()=>{try{await e.play(),e.controls=!1}catch{e.controls=!0}};if(e.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA){i();return}const d=()=>{i()};return e.addEventListener("loadeddata",d,{once:!0}),()=>{e.removeEventListener("loadeddata",d)}},[n]),s.jsx(F,{caption:t,children:s.jsx("video",{ref:a,src:n,className:"w-full h-auto object-cover",style:{objectPosition:"center"},preload:"auto",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,controls:!1,controlsList:"nodownload noremoteplayback"})})}function me({src:n,alt:t,borderWidth:a=8}){const e=`var(--stack-border-thickness, ${a}px)`;return s.jsx("div",{className:"relative w-full h-full",style:{transformOrigin:"50% 50%"},children:s.jsxs("div",{className:"absolute inset-0 overflow-hidden bg-white transition-shadow duration-300 ease-out shadow-[0px_6px_18px_0px_rgba(0,0,0,0.22)] group-hover:shadow-[0px_3px_12px_0px_rgba(0,0,0,0.16)]",children:[s.jsx("img",{src:n,alt:t,className:"absolute inset-0 w-full h-full object-contain select-none",style:{objectPosition:"center",userSelect:"none"},draggable:!1}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-solid border-white transition-shadow duration-300 ease-out shadow-[0px_4px_12px_0px_rgba(0,0,0,0.18)] group-hover:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.12)]",style:{borderWidth:e,inset:`calc(-1 * ${e})`}})]})})}class he{cache=new Map;loadingPromises=new Map;async getDimensions(t){if(this.cache.has(t))return this.cache.get(t);if(this.loadingPromises.has(t))return this.loadingPromises.get(t);const a=this.loadImageDimensions(t);this.loadingPromises.set(t,a);const e=await a;return this.loadingPromises.delete(t),e}loadImageDimensions(t){return new Promise(a=>{const e=new Image;e.onload=()=>{const i={width:e.naturalWidth,height:e.naturalHeight,aspectRatio:e.naturalWidth/e.naturalHeight};this.cache.set(t,i),a(i)},e.onerror=()=>a(null),e.src=t})}async preloadImages(t){await Promise.all(t.map(a=>this.getDimensions(a)))}getCached(t){return this.cache.get(t)??null}clear(){this.cache.clear(),this.loadingPromises.clear()}}const Y=new he;function pe(n){let t=0;for(let a=0;a<n.length;a++)t=(t<<5)-t+n.charCodeAt(a);return t>>>0}function ge(n){let t=n;return()=>(t=(1664525*t+1013904223)%4294967296)/4294967296}function fe({images:n,pageType:t="writing",height:a,mobileHeight:e,rotationMin:i=1.2,rotationMax:d=2.8,duration:m}){const[u,P]=r.useState(()=>n.map((o,c)=>c)),[f,x]=r.useState(!1),[N,S]=r.useState(!1),[R,g]=r.useState(!1),[v,W]=r.useState(0),[A,_]=r.useState(()=>{const o=new Map;return n.forEach((c,p)=>{const h=Y.getCached(c.src);h&&o.set(p,h)}),o}),L=re();r.useEffect(()=>{if(f&&window.matchMedia("(pointer: coarse)").matches){const c=setTimeout(()=>{x(!1),W(p=>p+1)},5e3);return()=>clearTimeout(c)}},[f]),r.useEffect(()=>{(async()=>{const c=new Map;await Promise.all(n.map(async(p,h)=>{const y=await Y.getDimensions(p.src);y&&c.set(h,y)})),_(c)})()},[n]);const B=r.useMemo(()=>{const o=Math.max(i,0),c=Math.max(d-i,0),p=Math.max(n.length-1,1),h=.35,y=[];return n.map((j,l)=>{const T=ge(pe(`${j.src}:${l}:${v}`)),w=l%2===0?1:-1,C=(l+v)%4<2?1:-1,b=l/p,M=o+c*b,$=Math.sin((v+l)*1.13)*.2;let I=w*(M+(T()-.5)*.32+$);Math.abs(I)<o*.65&&(I=w*o*.65);let U=0;for(;y.some(k=>Math.abs(k-I)<h)&&U<6;)I+=w*(h-.05),U+=1;y.push(I);const se=1+.25*Math.cos((v+l)*.9),V=(10+b*24)*se,ae=(T()-.5)*(3+b*3),ne=Math.sin((v+l)*.7)*2;let E=w*(V+ae)+ne;const ie=V*.42,oe=(T()-.5)*(2.5+b*2.5);let H=C*(ie+oe);const J=12+b*8;Math.abs(E)<J&&(E=(E===0?w:Math.sign(E))*J);const X=6+b*6;return Math.abs(H)<X&&(H=(H===0?C:Math.sign(H))*X),{angle:I,tx:E,ty:H}})},[n,i,d,v]),D=u[0]??0,G=n[D]?.caption,O=A.get(D),q=a??O?.height??360,K=O?O.width:void 0,Q=e??Math.round(q*.75),Z=()=>{if(N||R||u.length<2)return;g(!0),setTimeout(()=>S(!0),z*400),window.matchMedia("(pointer: coarse)").matches&&(x(!1),setTimeout(()=>x(!0),0))},ee=()=>{P(([o,...c])=>[...c,o]),S(!1),g(!1)},z=m??(L?0:.28),te=[.22,1,.36,1];return s.jsx(F,{pageType:t,caption:G,noBorder:!0,captionClassName:"mt-[3.25rem] md:mt-12",containerClassName:"mt-12 mb-10 md:mt-16 md:mb-18",children:s.jsx("div",{className:"relative w-full scale-[0.75] md:scale-100 [--stack-border-thickness:10.6667px] md:[--stack-border-thickness:8px]",style:{transformOrigin:"top center","--mobile-height":`${Q}px`,"--desktop-height":`${q}px`,height:"var(--mobile-height)",marginTop:"3rem",marginBottom:"2rem"},onMouseEnter:()=>x(!0),onMouseLeave:()=>{x(!1),W(o=>o+1)},children:s.jsx("div",{className:"group relative w-full mx-auto",style:{height:q,maxWidth:K},children:u.map((o,c)=>{const p=n[o],h=A.get(o),y=n.length-c,j=B[o]??{angle:0,tx:0,ty:0},l=c===0,T=f?0:j.angle,w=f?j.tx*.2:j.tx,C=f?j.ty*.35:j.ty,b=l&&N?0:1;let M="100%",$="100%";return h&&(a?(M=`${a*h.aspectRatio}px`,$=`${a}px`):(M=`${h.width}px`,$=`${h.height}px`)),s.jsx(ce.div,{className:"absolute left-1/2 top-1/2",style:{zIndex:y,transformOrigin:"50% 50%",width:M,height:$,marginLeft:`-${parseFloat(M)/2}${M.includes("px")?"px":"%"}`,marginTop:`-${parseFloat($)/2}${$.includes("px")?"px":"%"}`},initial:{opacity:1,y:C,rotate:T,x:w},animate:{opacity:b,y:l&&(R||N)?-28:C,rotate:T,x:w},transition:{duration:z,ease:te},onAnimationComplete:()=>{l&&N&&ee()},onClick:l?Z:void 0,role:l?"button":void 0,"aria-label":l?"Next photo":void 0,children:s.jsx(me,{src:p.src,alt:p.alt})},`${p.src}-${o}`)})})})})}function xe({src:n,alt:t,pageType:a="writing",caption:e,orientation:i,onToggle:d}){const[m,u]=r.useState(!1);return s.jsx(F,{pageType:a,orientation:i,caption:e,children:s.jsx("div",{className:"relative w-full h-auto cursor-pointer transition-opacity duration-200",onClick:d,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:s.jsx("img",{src:n,alt:t,className:"w-full h-auto object-cover bg-[#f5f5f5]",style:{objectPosition:"center",opacity:m?.9:1},loading:"lazy",decoding:"async",onError:P=>{P.currentTarget.style.visibility="hidden"}})})})}function ye({blocks:n}){return s.jsx("div",{className:"flex flex-col gap-4 w-full overflow-visible",children:n.map((t,a)=>{if(t.type==="sectionHeader")return s.jsxs("div",{className:"flex items-center gap-3 w-full mt-8 mb-2 overflow-visible",children:[s.jsx("span",{className:"portfolio-text halbfett whitespace-nowrap",children:t.title}),s.jsx("span",{className:"flex-1 border-t",style:{borderColor:"var(--portfolio-border)",transition:"border-color 900ms cubic-bezier(0.4, 0, 0.2, 1)"}})]},`section-${a}`);if(t.type==="text")return s.jsx("p",{className:"portfolio-text",children:t.content},`text-${a}`);if(t.type==="image"){const{image:e}=t;return s.jsx(le,{src:e.src,alt:e.alt,pageType:"writing",caption:e.caption},`image-${a}`)}if(t.type==="imageWithMagnifier"){const{image:e}=t;return s.jsx(de,{src:e.src,alt:e.alt,magnifierSrc:e.magnifierSrc,pageType:"writing",caption:e.caption},`image-magnifier-${a}`)}if(t.type==="imageNoBorder"){const{image:e}=t;return s.jsx("div",{className:"mt-10 mb-6 w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden h-[300px] md:h-[500px]",children:[s.jsx("img",{src:e.src,alt:e.alt,className:"w-full h-full object-cover",style:{objectPosition:"center 70%"},loading:"lazy",decoding:"async"}),e.caption&&s.jsx("figcaption",{className:"absolute -bottom-3 md:bottom-1 left-1/2 -translate-x-1/2 text-sm text-[#9c9c9b] leading-relaxed text-center whitespace-nowrap",children:e.caption})]})},`image-no-border-${a}`)}if(t.type==="imageThemeToggle"){const{image:e,onToggle:i}=t;return s.jsx(xe,{src:e.src,alt:e.alt,pageType:"writing",caption:e.caption,onToggle:i},`image-theme-toggle-${a}`)}if(t.type==="video"){const{video:e}=t;return s.jsx(ue,{src:e.src,caption:e.caption},`video-${a}`)}if(t.type==="quote"){const{quote:e,cite:i}=t;return s.jsxs("figure",{className:"mt-6 mb-4 pl-4 border-l-2",style:{borderColor:"var(--portfolio-border)"},children:[s.jsx("blockquote",{className:"portfolio-text halbfett text-[#9c9c9b]",children:e.split(`
`).map((d,m,u)=>s.jsxs("span",{children:[d,m<u.length-1&&s.jsx("br",{})]},`${a}-line-${m}`))}),i&&s.jsxs("figcaption",{className:"mt-2 text-sm text-[#9c9c9b]",children:["â€” ",i]})]},`quote-${a}`)}if(t.type==="framedText"){const{text:e,height:i}=t,d=i??200;return s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"mt-10 mb-6 inline-image-container w-full md:w-[115%] md:-ml-[7.5%]",children:s.jsxs("div",{className:"relative w-full overflow-hidden shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",children:[s.jsx("div",{className:"w-full flex items-center justify-center bg-white",style:{height:`${d}px`},children:s.jsx("span",{className:"portfolio-text text-[#6a6a6a]",children:e})}),s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-[8px] border-solid border-white inset-[-8px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]"})]})})},`framed-${a}`)}return t.type==="imageStack"?s.jsx(fe,{images:t.stack,pageType:"writing",height:t.height,mobileHeight:t.mobileHeight},`stack-${a}`):null})})}export{ye as W,Y as i};
