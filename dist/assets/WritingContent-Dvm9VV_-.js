import{h as E,i as q,r as f,p as F,j as e,m as O}from"./index-BMcYsf5r.js";import{a as b,P as z,I as A}from"./withContentPage-DDT0L5jp.js";function H(){!E.current&&q();const[r]=f.useState(F.current);return r}function W({src:r,caption:a}){return e.jsx(b,{caption:a,children:e.jsx("video",{src:r,className:"w-full h-auto object-cover",style:{objectPosition:"center"},preload:"metadata",autoPlay:!0,loop:!0,muted:!0,playsInline:!0})})}function L({src:r,alt:a,borderWidth:i=8}){return e.jsx("div",{className:"relative w-full h-full",style:{transformOrigin:"50% 50%"},children:e.jsx("div",{className:"absolute inset-0 bg-white shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",style:{padding:i},children:e.jsx(z,{src:r,alt:a,priority:!0,containerClassName:"relative w-full h-full",className:"absolute left-0 top-0 w-full h-full select-none",style:{objectPosition:"center",userSelect:"none"},draggable:!1,placeholderClassName:"bg-[#f1f1f1]"})})})}function D(r){let a=0;for(let i=0;i<r.length;i++)a=(a<<5)-a+r.charCodeAt(i);return a>>>0}function V(r){let a=r;return()=>(a=(1664525*a+1013904223)%4294967296)/4294967296}function X({images:r,pageType:a="writing",height:i=360,rotationMin:t=.5,rotationMax:s=1.5,duration:n}){const[o,u]=f.useState(()=>r.map((c,l)=>l)),[w,v]=f.useState(!1),[p,j]=f.useState(!1),I=H(),C=f.useMemo(()=>{const c=Math.max(t,0),l=Math.max(s-t,0);return r.map((h,x)=>{const m=V(D(h.src+":"+x)),d=(m()*l+c)*(m()>.5?1:-1),g=m()*2-1;return{angle:d,tx:g}})},[r,t,s]),_=o[0]??0,S=r[_]?.caption,M=()=>{p||o.length<2||j(!0)},P=()=>{u(([c,...l])=>[...l,c]),j(!1)},T=n??(I?0:.4),$=[.25,.46,.45,.94];return e.jsx(b,{pageType:a,caption:S,children:e.jsx("div",{className:"relative w-full",onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:e.jsx("div",{className:"relative w-full",style:{height:i},children:o.map((c,l)=>{const h=r[c],x=r.length-l,m=C[c]??{angle:0,tx:0},d=l===0,g=l===1,y=w?0:m.angle,N=w?0:m.tx,R=d&&p?0:1;return e.jsx(O.div,{className:"absolute inset-0",style:{zIndex:x,transformOrigin:"50% 50%"},initial:{opacity:1,y:0,rotate:y,x:N},animate:{opacity:R,y:d&&p?-28:0,rotate:y,x:N},transition:{duration:T,ease:$},onAnimationComplete:()=>{d&&p&&P()},onClick:d?M:void 0,role:d?"button":void 0,"aria-label":d?"Next photo":void 0,children:e.jsx(L,{src:h.src,alt:h.alt})},`${h.src}-${c}`)})})})})}function J({blocks:r}){const a=f.useMemo(()=>{const t=new Set;return r.forEach(s=>{s.type==="image"&&t.add(s.image.src),s.type==="imageStack"&&s.stack.forEach(n=>t.add(n.src))}),Array.from(t)},[r]);f.useEffect(()=>{if(typeof window>"u"||a.length===0)return;const t=()=>{a.forEach(o=>{const u=new Image;u.decoding="async",u.loading="eager",u.src=o})},s=window;if(s.requestIdleCallback){const o=s.requestIdleCallback(t);return()=>s.cancelIdleCallback?.(o)}const n=window.setTimeout(t,0);return()=>window.clearTimeout(n)},[a]);let i=!1;return e.jsx("div",{className:"flex flex-col gap-4 w-full overflow-visible",children:r.map((t,s)=>{if(t.type==="sectionHeader")return e.jsxs("div",{className:"flex items-center gap-3 w-full mt-8 mb-2 overflow-visible",children:[e.jsx("span",{className:"portfolio-text halbfett whitespace-nowrap",children:t.title}),e.jsx("span",{className:"flex-1 border-t",style:{borderColor:"var(--portfolio-border)"}})]},`section-${s}`);if(t.type==="text")return e.jsx("p",{className:"portfolio-text",children:t.content},`text-${s}`);if(t.type==="image"){const{image:n}=t,o=!i;return i=!0,e.jsx(A,{src:n.src,alt:n.alt,pageType:"writing",caption:n.caption,priority:o},`image-${s}`)}if(t.type==="video"){const{video:n}=t;return e.jsx(W,{src:n.src,caption:n.caption},`video-${s}`)}if(t.type==="quote"){const{quote:n,cite:o}=t;return e.jsxs("figure",{className:"mt-6 mb-4 pl-4 border-l-2",style:{borderColor:"var(--portfolio-border)"},children:[e.jsx("blockquote",{className:"portfolio-text halbfett text-[#9c9c9b]",children:n}),o&&e.jsxs("figcaption",{className:"mt-2 text-sm text-[#9c9c9b]",children:["â€” ",o]})]},`quote-${s}`)}if(t.type==="framedText"){const{text:n,height:o}=t,u=o??200;return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"mt-10 mb-6 inline-image-container w-full md:w-[115%] md:-ml-[7.5%]",children:e.jsxs("div",{className:"relative w-full overflow-hidden shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]",children:[e.jsx("div",{className:"w-full flex items-center justify-center bg-white",style:{height:`${u}px`},children:e.jsx("span",{className:"portfolio-text text-[#6a6a6a]",children:n})}),e.jsx("div",{"aria-hidden":"true",className:"pointer-events-none absolute border-[8px] border-solid border-white inset-[-8px] shadow-[0px_2px_8px_0px_rgba(0,0,0,0.15)]"})]})})},`framed-${s}`)}return t.type==="imageStack"?e.jsx(X,{images:t.stack,pageType:"writing",height:t.height},`stack-${s}`):null})})}export{J as W};
